{"version":3,"file":"sermons-list.component.js","sourceRoot":"","sources":["../../../src/app/components/sermons-list/sermons-list.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, ElementRef, OnChanges, OnInit } from '@angular/core';\nimport { SearchSermons } from '../../pipes/search-sermons.pipe';\nimport { Array } from '../../pipes/array.pipe';\nimport { FromUnixPipe, DateFormatPipe } from 'angular2-moment';\nimport { PaginationComponent } from '../pagination/index';\nimport { PaginatePipe, IPaginationInstance, PaginationService } from 'ng2-pagination';\nimport { AudioService } from '../../services/audio.service';\nimport { OrderBy } from '../../pipes/order-by.pipe';\nimport { GlobalEventsService } from '../../services/global-events.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'as-sermons-list',\n  templateUrl: 'sermons-list.component.html',\n  styleUrls: ['sermons-list.component.css'],\n  pipes: [SearchSermons, FromUnixPipe, DateFormatPipe, PaginatePipe, Array, OrderBy],\n  directives: [PaginationComponent],\n  providers: [PaginationService]\n})\nexport class SermonsListComponent implements OnChanges, OnInit {\n  @Input() sermons;\n  @Input() filterValues;\n  @Input() lastChange;\n  public filteredItems = 0;\n  public page;\n  public test;\n  public current;\n  public showPagesComponent = true;\n  public domHeight;\n  public domScroll;\n  public filteredCount = {count: 0};\n  public filterReadable;\n  public config: IPaginationInstance = {\n      id: 'custom',\n      itemsPerPage: 25,\n      currentPage: 1\n  };\n  constructor(\n    public audioService: AudioService,\n    public element: ElementRef,\n    public globalEventsService: GlobalEventsService) {\n    this.audioService.currentAudio$.subscribe(data => {\n      this.test = new Date().getTime();\n      this.current = data;\n    });\n  }\n  ngOnInit() {\n    this.globalEventsService.scroll$.subscribe(data => {\n      let yPos = data.path[1].pageYOffset;\n      this.domScroll = yPos;\n    });\n  }\n  ngOnChanges(changes) {\n      this.checkHeight();\n      this.getFiltered();\n      this.showPagesComponent = true;\n  }\n\n  getFiltered() { // use to display an error message for no search results\n\n    let filteredArray = [];\n    let defaults = ['', 'All books', 'All years', 'AM/PM'];\n    for (let key in this.filterValues) {\n      if (defaults.indexOf( this.filterValues[key] ) === -1) {\n        filteredArray.push( this.filterValues[key] );\n      }\n    }\n    for (let i = 0; i < filteredArray.length; i++) {\n      if (i === 0) {\n        this.filterReadable = '\"' + filteredArray[i] + '\"';\n      } else if (filteredArray.length === i + 1) {\n        this.filterReadable += ', and \"' + filteredArray[i] + '\"';\n      } else {\n        this.filterReadable += ', \"' + filteredArray[i] + '\"';\n      }\n    }\n  }\n\n  pageChange() {\n    this.checkHeight();\n    setTimeout( () => {\n      this.checkHeight();\n    }, 50);\n  }\n\n  checkHeight() {\n      let newHeight = this.element.nativeElement.firstChild.offsetHeight;\n      let navs = 54 + 50;\n      let offsetTop = this.element.nativeElement.offsetTop;\n      let offset = offsetTop - navs;\n      let diff = (offset -  this.domScroll) * -1;\n      if (newHeight < this.domHeight) {\n        let heightChange = this.domHeight - newHeight;\n        let change;\n        if (diff > heightChange) {\n          change = heightChange;\n        } else {\n          change = diff;\n        }\n        let newScroll = this.domScroll - change;\n        window.scrollTo(0, newScroll);\n        let changeScroll;\n        if (offset > 0) {\n          if (heightChange > offset) {\n            changeScroll = offset;\n          } else {\n            changeScroll = heightChange;\n          }\n        }\n      }\n      this.domHeight = newHeight;\n  }\n}\n"]}